<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Dashboard</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../static/css/style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.131.3/build/three.min.js"></script> <!-- For 3D Rendering -->
</head>

<body>
    <!-- Sidebar Navigation -->
    <div class="sidebar">
        <div class="sidebar-header">
            <h2>Leaf Health Dashboard</h2>
        </div>
        <ul class="sidebar-links">
            <li><a href="#section1">Upload Section</a></li>
            <li><a href="#section2">3D Leaf Viewer</a></li>
            <li><a href="#section3">AI Prediction</a></li>
            <li><a href="#section4">Data Log</a></li>
            <li><a href="#section5">Parameter Comparison</a></li>
        </ul>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <header>
            <h1>Interactive Dashboard</h1>
            <a href="../templates/landpage.html" class="btn-primary">Home Page</a>
            <a href="../templates/allproducts.html" class="btn-primary">Explore Our Products</a>
            <a href="../templates/chatbot.html" class="btn-primary">Try Vriksha GPT</a>
            <button class="theme-toggle" onclick="toggleTheme()">â˜¼/ðŸŒœï¸Žï¸Ž</button>
        </header>
        <div class="container">
            <!-- Upload Section -->
            <section id="section1">
                <h2>Upload Leaf Image</h2>
                <div class="upload-section">
                    <input type="file" id="imageUpload" accept="image/*" onchange="previewImage(event)">
                    <div id="dropzone" ondrop="handleDrop(event)" ondragover="handleDragOver(event)" ondragleave="handleDragLeave(event)">Drag and Drop Files Here</div>
                    <div id="imagePreview"></div>
                </div>
            </section>

            <!-- 3D Leaf Viewer -->
            <section id="section2">
                <h2>3D Leaf Viewer</h2>
                <div class="viewer-section">
                    <div id="leaf3d"></div>
                </div>
            </section>

            <!-- AI Prediction -->
            <section id="section3">
                <h2>AI Prediction</h2>
                <div class="ai-prediction">
                    <p>AI Prediction Result: <span id="aiPredictionBox">Data based on model analysis...</span></p>
                </div>
            </section>

            <!-- Data Log -->
            <section id="section4">
                <h2>Data Log</h2>
                <div class="data-log">
                    <table>
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Moisture</th>
                                <th>Nutrients</th>
                                <th>Disease</th>
                            </tr>
                        </thead>
                        <tbody id="logTableBody">
                            <tr>
                                <td>2025-04-06</td>
                                <td>85%</td>
                                <td>72%</td>
                                <td>25%</td>
                            </tr>
                            <tr>
                                <td>2025-04-07</td>
                                <td>90%</td>
                                <td>80%</td>
                                <td>20%</td>
                            </tr>
                        </tbody>
                    </table>
                    <form id="logForm">
                        <input type="date" id="logDate" required>
                        <input type="number" id="logMoisture" placeholder="Moisture" required>
                        <input type="number" id="logNutrients" placeholder="Nutrients" required>
                        <input type="number" id="logDisease" placeholder="Disease" required>
                        <button type="submit">Add Log Entry</button>
                    </form>
                </div>
            </section>

            <!-- Parameter Comparison -->
            <section id="section5">
                <h2>Parameter Comparison</h2>
                <div class="comparison-cards">
                    <div class="param-card">
                        <strong>Growth Rate</strong>
                        <p>85%</p>
                    </div>
                    <div class="param-card">
                        <strong>Leaf Width</strong>
                        <p>15 cm</p>
                    </div>
                    <div class="param-card">
                        <strong>Sunlight Exposure</strong>
                        <p>High</p>
                    </div>
                </div>
            </section>

            <!-- Charts Section -->
            <section id="section6">
                <h2>Charts and Data Visualizations</h2>
                <div class="chart-container">
                    <canvas id="barChart"></canvas>
                    <canvas id="lineChart"></canvas>
                    <canvas id="radarChart"></canvas>
                </div>
            </section>
        </div>
    </div>

    <script src="../static/js/script.js"></script>

    <script>
        // Handle image preview after selecting a file
        function previewImage(event) {
            var reader = new FileReader();
            reader.onload = function () {
                var output = document.getElementById('imagePreview');
                output.innerHTML = '<img src="' + reader.result + '" width="300" height="300">';
            };
            reader.readAsDataURL(event.target.files[0]);
        }

        // Handle the file upload and AI prediction result
        function uploadFile() {
            var file = document.getElementById('imageUpload').files[0];
            var formData = new FormData();
            formData.append('file', file);

            fetch('/predict', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(result => {
                document.getElementById('aiPredictionBox').innerText = "Predicted Disease: " + result.prediction;
            })
            .catch(error => {
                console.error('Error:', error);
            });
        }

        // Handle drag-and-drop
        function handleDrop(event) {
            event.preventDefault();
            var files = event.dataTransfer.files;
            if (files.length > 0) {
                document.getElementById('imageUpload').files = files;
                previewImage(event);
            }
        }

        function handleDragOver(event) {
            event.preventDefault();
            document.getElementById('dropzone').classList.add('active');
        }

        function handleDragLeave(event) {
            event.preventDefault();
            document.getElementById('dropzone').classList.remove('active');
        }
    </script>
</body>
</html>
